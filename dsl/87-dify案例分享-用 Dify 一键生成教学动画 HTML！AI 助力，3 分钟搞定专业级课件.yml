app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: 87-difyæ¡ˆä¾‹åˆ†äº«-ç”¨ Dify ä¸€é”®ç”Ÿæˆæ•™å­¦åŠ¨ç”» HTMLï¼AI åŠ©åŠ›ï¼Œ3 åˆ†é’Ÿæå®šä¸“ä¸šçº§è¯¾ä»¶
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai_api_compatible:0.0.16@77274df8fe2632cac66bfd153fcc75aa5e96abbe92b5c611b8984ad9f4cd4457
    version: null
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables:
  - description: ''
    id: 37c0fd7e-ba1f-4417-9cb6-2e719b9238c0
    name: apiurl
    selector:
    - env
    - apiurl
    value: http://14.103.204.132:8080/generate-html/
    value_type: string
  - description: ''
    id: 7149dc92-db46-4db9-bb7a-f46830becdac
    name: apikey
    selector:
    - env
    - apikey
    value: sk-zhouhui1122444
    value_type: string
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 500
        batch_count_limit: 50
        file_size_limit: 100
        image_file_size_limit: 100
        video_file_size_limit: 500
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: answer
      id: 1750930181769-source-1750931224218-target
      source: '1750930181769'
      sourceHandle: source
      target: '1750931224218'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1750772983167-source-1750930181769-target
      source: '1750772983167'
      sourceHandle: source
      target: '1750930181769'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1750771695281-source-1750772983167-target
      source: '1750771695281'
      sourceHandle: source
      target: '1750772983167'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables: []
      height: 53
      id: '1750771695281'
      position:
        x: 201.00000000000006
        y: 299.00000000000006
      positionAbsolute:
        x: 201.00000000000006
        y: 299.00000000000006
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gemini-2.5-pro
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 6cd19724-8b18-43bd-a927-e6364ba97815
          role: system
          text: "# Role: ç²¾ç¾åŠ¨æ€åŠ¨ç”»ç”Ÿæˆä¸“å®¶\n\n## Profile\n- author: å‘¨è¾‰\n- version: 2.0\n\
            - language: ä¸­æ–‡\n- description: ä¸“æ³¨äºç”Ÿæˆç¬¦åˆ2Kåˆ†è¾¨ç‡æ ‡å‡†çš„ã€è§†è§‰ç²¾ç¾çš„ã€è‡ªåŠ¨æ’­æ”¾çš„æ•™è‚²åŠ¨ç”»HTMLé¡µé¢ï¼Œç¡®ä¿æ‰€æœ‰å…ƒç´ æ­£ç¡®å¸ƒå±€ä¸”æ— è§†è§‰ç¼ºé™·\n\
            \n## Skills\n1. ç²¾é€šHTML5ã€CSS3ã€JavaScriptå’ŒSVGæŠ€æœ¯æ ˆ\n2. æ“…é•¿å“åº”å¼å¸ƒå±€å’Œå›ºå®šåˆ†è¾¨ç‡å®¹å™¨è®¾è®¡\n\
            3. ç†Ÿç»ƒæŒæ¡åŠ¨ç”»æ—¶é—´è½´ç¼–æ’å’Œè§†è§‰å™äº‹\n4. ç²¾é€šæµ…è‰²é…è‰²æ–¹æ¡ˆå’Œç°ä»£UIè®¾è®¡ç¾å­¦\n5. èƒ½å¤Ÿå®ç°åŒè¯­å­—å¹•å’Œæ—ç™½å¼æ–‡å­—è§£è¯´ç³»ç»Ÿ\n\n##\
            \ Background\nç”¨æˆ·éœ€è¦ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„å•æ–‡ä»¶HTMLåŠ¨ç”»ï¼Œç”¨äºçŸ¥è¯†ç‚¹è®²è§£ã€‚è¯¥åŠ¨ç”»å¿…é¡»åœ¨å›ºå®šçš„2Kåˆ†è¾¨ç‡å®¹å™¨ï¼ˆ1280px Ã— 720pxï¼‰ä¸­å®Œç¾å‘ˆç°ï¼Œé¿å…ä»»ä½•å¸ƒå±€é”™è¯¯ã€å…ƒç´ ç©¿æ¨¡æˆ–å­—å¹•é®æŒ¡é—®é¢˜ã€‚\n\
            \n## Goals\n1. ç”Ÿæˆè§†è§‰ç²¾ç¾ã€è®¾è®¡æ„Ÿå¼ºçš„åŠ¨æ€åŠ¨ç”»é¡µé¢\n2. ç¡®ä¿æ‰€æœ‰å…ƒç´ åœ¨1280px Ã— 720pxå®¹å™¨å†…æ­£ç¡®å®šä½\n3.\
            \ å®ç°æ¸…æ™°çš„å¼€åœºã€è®²è§£è¿‡ç¨‹å’Œæ”¶å°¾ç»“æ„\n4. æä¾›åŒè¯­å­—å¹•å’Œæ—ç™½å¼è§£è¯´\n5. åœ¨åŠ¨ç”»ç»“æŸæ—¶æ’å…¥å®Œç»“æ ‡è®°ä¾›å½•åˆ¶åˆ¤æ–­\n\n## Constraints\n\
            1. åˆ†è¾¨ç‡çº¦æŸï¼šæ‰€æœ‰å†…å®¹å¿…é¡»åœ¨å›ºå®šçš„1280pxå®½ Ã— 720pxé«˜çš„å®¹å™¨å†…å‘ˆç°\n2. è§†è§‰å®Œæ•´æ€§ï¼šç¦æ­¢å‡ºç°å…ƒç´ ç©¿æ¨¡ã€å­—å¹•é®æŒ¡ã€å›¾å½¢ä½ç½®é”™è¯¯\n\
            3. æŠ€æœ¯æ ˆï¼šä»…ä½¿ç”¨HTML + CSS + JS + SVGï¼Œä¸ä¾èµ–å¤–éƒ¨åº“ï¼Œèµ„æºå°½é‡å†…åµŒ\n4. è‡ªåŠ¨æ’­æ”¾ï¼šé¡µé¢åŠ è½½åç«‹å³å¼€å§‹æ’­æ”¾ï¼Œæ— äº¤äº’æŒ‰é’®\n\
            5. å•æ–‡ä»¶è¾“å‡ºï¼šæ‰€æœ‰èµ„æºå†…åµŒåœ¨ä¸€ä¸ªHTMLæ–‡ä»¶ä¸­\n6. å®Œç»“æ ‡è®°ï¼šåŠ¨ç”»ç»“æŸæ—¶å¿…é¡»æ‰§è¡ŒæŒ‡å®šçš„JavaScriptå®Œç»“é€»è¾‘\n\n## OutputFormat\n\
            è¯·ä¸¥æ ¼è¾“å‡ºä»¥ä¸‹ç»“æ„çš„å®Œæ•´HTMLæ–‡æ¡£ï¼Œå¹¶ä½¿ç”¨ä»£ç å—åŒ…è£¹ï¼ˆ```html å¼€å¤´ï¼Œ``` ç»“å°¾ï¼‰ï¼š\n```html\n<!DOCTYPE html>\n\
            <html lang=\\\"zh-CN\\\">\n<head>\n  <meta charset=\\\"UTF-8\\\"> \n \
            \ <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\
            \">\n  <title>{{{{ä¸»é¢˜æ ‡é¢˜}}}}</title>\n  <style>\n    /* ç¡®ä¿å®¹å™¨å›ºå®šä¸º2Kåˆ†è¾¨ç‡ */\n\
            \    :root {{\n      --bg: #f6f7fb;\n      --panel: #ffffff;\n      --text:\
            \ #223;\n      --accent: #4a90e2;\n      --sub: #7b8ba8;\n    }}\n   \
            \ html, body {{ height: 100%; }}\n    body {{\n      margin: 0; padding:\
            \ 0; display: flex; justify-content: center; align-items: center;\n  \
            \    min-height: 100vh; background: var(--bg); overflow: hidden; color:\
            \ var(--text);\n      font-family: -apple-system, BlinkMacSystemFont,\
            \ 'Inter', 'Segoe UI', Roboto, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft\
            \ YaHei', sans-serif;\n    }}\n    #animation-container {{\n      position:\
            \ relative; width: 1280px; height: 720px; background: var(--panel); overflow:\
            \ hidden;\n      box-shadow: 0 0 50px rgba(0,0,0,0.08); border-radius:\
            \ 20px;\n    }}\n    /* å»ºè®®çš„å­—å¹•åŒºåŸŸï¼ˆåº•éƒ¨å±…ä¸­ï¼Œ150-200px é«˜ï¼‰ */\n    .subtitles {{\
            \ position: absolute; left: 0; right: 0; bottom: 40px; height: 180px;\
            \ display: flex; align-items: center; justify-content: center; pointer-events:\
            \ none; }}\n    .subtitles .line {{\n      background: rgba(255,255,255,0.85);\
            \ color: #111; border-radius: 12px; padding: 18px 24px; font-size: 40px;\
            \ line-height: 1.3; max-width: 80%; text-align: center; box-shadow: 0\
            \ 8px 24px rgba(0,0,0,.08);\n    }}\n    /* å…¶ä»–æ ·å¼... */\n  </style>\n \
            \ </head>\n  <body>\n    <div id=\\\"animation-container\\\">\n      <!--\
            \ åœ¨æ­¤æ”¾ç½®SVG/å›¾å½¢/è®²è§£å…ƒç´ ï¼Œç¡®ä¿å…³é”®è§†è§‰ä½äºä¸­å¿ƒåŒºåŸŸçš„60-70%ï¼Œä¿ç•™20-30pxå®‰å…¨è¾¹è· -->\n      <div class=\\\
            \"subtitles\\\"><div id=\\\"sub-cn\\\" class=\\\"line\\\"></div></div>\n\
            \      <div class=\\\"subtitles\\\" style=\\\"bottom: 240px;\\\"><div\
            \ id=\\\"sub-en\\\" class=\\\"line\\\"></div></div>\n    </div>\n    <script>\n\
            \      // åŠ¨ç”»é€»è¾‘ç¤ºä¾‹ï¼šè¯·åœ¨æ­¤å®ç°å¼€åœº(5-10s) â†’ è®²è§£(30-60s) â†’ æ”¶å°¾(5-10s) çš„æ—¶é—´è½´\n      //\
            \ å¹¶ç¡®ä¿å…ƒç´ åŠ¨ç”»æµç•…ã€æ— ç©¿æ¨¡ï¼Œä¸å­—å¹•åŒæ­¥ã€‚\n\n      function setSubtitles(cn, en) {{\n   \
            \     const cnEl = document.getElementById('sub-cn');\n        const enEl\
            \ = document.getElementById('sub-en');\n        if (cnEl) cnEl.textContent\
            \ = cn || '';\n        if (enEl) enEl.textContent = en || '';\n      }}\n\
            \n      // åŠ¨ç”»ç»“æŸæ—¶çš„å®Œç»“æ ‡è®°ï¼ˆå¿…é¡»åŒ…å«ï¼‰\n      function markAnimationFinished() {{\n\
            \        try {{\n          window.playFinished = true;\n          window.dispatchEvent(new\
            \ Event('recording:finished'));\n          var flag = document.createElement('div');\n\
            \          flag.id = 'finished-flag';\n          flag.style.display =\
            \ 'none';\n          document.body.appendChild(flag);\n        }} catch\
            \ (e) {{ /* no-op */ }}\n      }}\n\n      // è¯·åœ¨æœ€åä¸€ä¸ªåŠ¨ç”»ç»“æŸåè°ƒç”¨ markAnimationFinished();\n\
            \      // markAnimationFinished();\n    </script>\n  </body>\n</html>\n\
            ```\n\n## Workflows\n1. æ¥æ”¶ä¸»é¢˜ï¼šè·å–ç”¨æˆ·æŒ‡å®šçš„çŸ¥è¯†ç‚¹ä¸»é¢˜ï¼ˆæœ¬æ¬¡ä¸»é¢˜ï¼š{{#sys.query#}}ï¼‰ã€‚\n2. ç»“æ„è§„åˆ’ï¼šè®¾è®¡å¼€åœºï¼ˆ5-10ç§’ï¼‰â†’\
            \ æ ¸å¿ƒè®²è§£ï¼ˆ30-60ç§’ï¼‰â†’ æ”¶å°¾ï¼ˆ5-10ç§’ï¼‰çš„æ—¶é—´è½´ã€‚\n3. è§†è§‰è®¾è®¡ï¼šé€‰æ‹©å’Œè°æµ…è‰²é…è‰²ï¼Œç²¾å‡†å¸ƒå±€åˆ° 1280Ã—720 å®¹å™¨ï¼Œå­—å¹•åŒºåŸŸåº•éƒ¨å±…ä¸­ã€‚\n\
            4. åŠ¨ç”»ç¼–æ’ï¼šç”¨CSSåŠ¨ç”»/JSæ§åˆ¶æ—¶é—´è½´ï¼Œä¿è¯æµç•…ä¸æ— ç©¿æ¨¡ï¼Œå­—å¹•ä¸è§†è§‰åŒæ­¥ã€‚\n5. å®Œç»“é€»è¾‘ï¼šåœ¨æœ€åä¸€ä¸ªåŠ¨ç”»å®Œæˆåå¿…é¡»è°ƒç”¨ markAnimationFinished()ã€‚\n\
            6. è´¨é‡æ£€æŸ¥ï¼šå…ƒç´ ä¸è¶Šç•Œã€å­—å¹•ä¸é®æŒ¡å…³é”®è§†è§‰ã€é…è‰²å’Œè°æ˜“è¯»ã€‚\n7. è¾“å‡ºäº¤ä»˜ï¼šä»…è¾“å‡ºå®Œæ•´å•æ–‡ä»¶HTMLï¼Œå¹¶ç”¨ ```html ä»£ç å—åŒ…è£¹ã€‚\n\
            \n## Suggestions\n1. ä½¿ç”¨CSS Gridæˆ–Flexboxç²¾ç¡®æ§åˆ¶1280Ã—720å®¹å™¨å†…çš„å¸ƒå±€ã€‚\n2. å­—å¹•å­—å·å»ºè®®32-48pxï¼Œç¡®ä¿2Kåˆ†è¾¨ç‡ä¸‹æ¸…æ™°å¯è¯»ã€‚\n\
            3. å…³é”®è§†è§‰å…ƒç´ åº”å æ®å®¹å™¨ä¸­å¿ƒåŒºåŸŸçš„60-70%ã€‚\n4. ä½¿ç”¨CSSå˜é‡ç»Ÿä¸€ç®¡ç†é…è‰²æ–¹æ¡ˆã€‚\n5. åŠ¨ç”»æ€»æ—¶é•¿å»ºè®®40-90ç§’ã€‚\n6.\
            \ å…³é”®å†…å®¹ä¿æŒ20-30pxå®‰å…¨è¾¹è·ï¼Œé˜²æ­¢æº¢å‡ºã€‚\n\n## Output Rule\n- ä»…è¾“å‡ºå®Œæ•´ã€å¯ç›´æ¥ä¿å­˜ä¸º .html çš„å•æ–‡ä»¶æºç ã€‚\n\
            - å¿…é¡»ä½¿ç”¨ ```html ä»£ç å—åŒ…è£¹ï¼›ä¸å¾—è¾“å‡ºè¯´æ˜æ–‡å­—æˆ–å¤šä½™å†…å®¹ã€‚"
        - id: 1d7c7040-80b2-46a2-b6c9-acc6c75ac119
          role: user
          text: è¯·æ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯{{#sys.query#}}ç”ŸæˆHTMLä»£ç 
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1750772983167'
      position:
        x: 573.0198086136584
        y: 299.00000000000006
      positionAbsolute:
        x: 573.0198086136584
        y: 299.00000000000006
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\nimport re\nimport time\nimport requests\n\ndef main(json_html:\
          \ str, apikey: str,apiurl: str) -> dict:\n    try:\n        # å»é™¤è¾“å…¥å­—ç¬¦ä¸²ä¸­çš„\
          \ ```html å’Œ ``` æ ‡è®°\n        match = re.search(r'```html\\s*([\\s\\S]*?)```',\
          \ json_html, re.DOTALL)\n        \n        if match:\n            # group(1)\
          \ è·å–ç¬¬ä¸€ä¸ªæ•è·ç»„çš„å†…å®¹ï¼Œå³çº¯HTMLä»£ç \n            # .strip() å»é™¤å¯èƒ½å­˜åœ¨çš„å‰åç©ºç™½\n           \
          \ html_content = match.group(1).strip()\n        else:\n            # å¦‚æœåœ¨è¾“å…¥ä¸­æ‰¾ä¸åˆ°HTMLä»£ç å—ï¼Œåˆ™è¿”å›é”™è¯¯\n\
          \            raise ValueError(\"æœªèƒ½åœ¨è¾“å…¥ä¸­æ‰¾åˆ° ```html ... ``` ä»£ç å—ã€‚\")\n     \
          \   \n        # ç”Ÿæˆæ—¶é—´æˆ³ï¼Œç¡®ä¿æ–‡ä»¶åå”¯ä¸€\n        timestamp = int(time.time())\n  \
          \      filename = f\"makehtml_{timestamp}.html\"\n        \n        # APIç«¯ç‚¹ï¼ˆå‡è®¾æœ¬åœ°è¿è¡Œï¼‰\n\
          \        url = f\"{apiurl}\"\n        \n        # è¯·æ±‚æ•°æ®\n        payload\
          \ = {\n            \"html_content\": html_content,\n            \"filename\"\
          : filename  # ä½¿ç”¨ä¼ å…¥çš„æ–‡ä»¶å\n        }\n        \n        # è®¾ç½®è¯·æ±‚å¤´ï¼ˆåŒ…å«è®¤è¯tokenï¼‰\n\
          \        headers = {\n            \"Authorization\": f\"Bearer {apikey}\"\
          ,  # æ›¿æ¢ä¸ºå®é™…çš„è®¤è¯token\n            \"Content-Type\": \"application/json\"\n\
          \        }\n        \n        try:\n            # å‘é€POSTè¯·æ±‚\n           \
          \ response = requests.post(url, json=payload, headers=headers)\n       \
          \     \n            # æ£€æŸ¥å“åº”çŠ¶æ€\n            if response.status_code == 200:\n\
          \                result = response.json()\n                html_url = result.get(\"\
          html_url\", \"\")\n                generated_filename = result.get(\"filename\"\
          , \"\")\n                \n                # è¿”å›ç»“æœ\n                return\
          \ {\n                    \"html_url\": html_url,\n                    \"\
          filename\": generated_filename,\n                    \"markdown_result\"\
          :  f\"[ç‚¹å‡»æŸ¥çœ‹]({html_url})\"\n                }\n            else:\n     \
          \           raise Exception(f\"HTTP Error: {response.status_code}, Message:\
          \ {response.text}\")\n        \n        except requests.exceptions.RequestException\
          \ as e:\n            raise Exception(f\"Request failed: {str(e)}\")\n  \
          \  \n    except Exception as e:\n        return {\n            \"error\"\
          : f\"Error: {str(e)}\"\n        }"
        code_language: python3
        desc: ''
        outputs:
          filename:
            children: null
            type: string
          html_url:
            children: null
            type: string
          markdown_result:
            children: null
            type: string
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - '1750772983167'
          - text
          variable: json_html
        - value_selector:
          - env
          - apikey
          variable: apikey
        - value_selector:
          - env
          - apiurl
          variable: apiurl
      height: 53
      id: '1750930181769'
      position:
        x: 911.1758624394756
        y: 299.00000000000006
      positionAbsolute:
        x: 911.1758624394756
        y: 299.00000000000006
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: ' {{#1750930181769.html_url#}}

          {{#1750930181769.markdown_result#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 123
      id: '1750931224218'
      position:
        x: 1264.144168657622
        y: 299.00000000000006
      positionAbsolute:
        x: 1264.144168657622
        y: 299.00000000000006
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    viewport:
      x: -613.2153203500561
      y: -22.735268852778944
      zoom: 1.5157165815395615
  rag_pipeline_variables: []
