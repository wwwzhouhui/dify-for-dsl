app:
  description: æœ¬å·¥ä½œæµä¸»è¦åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ä»£ç ç”Ÿæˆèƒ½åŠ›é€šè¿‡ç”¨æˆ·è¾“å…¥çš„è¡¨æ ¼è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„HTMLä»£ç å¹¶åœ¨æœ€åæ¸²æŸ“å‡ºç»Ÿè®¡å›¾ç­‰åŠŸèƒ½ã€‚
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: å¤§æ¨¡å‹è¡¨æ ¼è§£æè‡ªåŠ¨ç”Ÿæˆä»£ç ç”Ÿæˆç»Ÿè®¡å›¾
  use_icon_as_answer_icon: true
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables:
  - description: ''
    id: 08c373b3-8019-4349-b016-57242eeedac7
    name: apiurl
    selector:
    - env
    - apiurl
    value: http://192.168.1.1:8080/generate-html/
    value_type: string
  - description: ''
    id: ad572f95-3e7e-441c-a888-7e51b74bd437
    name: apikey
    selector:
    - env
    - apikey
    value: sk-zhouhuixxxxx
    value_type: string
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: document-extractor
      id: 1741751677458-source-1741751683774-target
      source: '1741751677458'
      sourceHandle: source
      target: '1741751683774'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: document-extractor
        targetType: llm
      id: 1741751683774-source-llm-target
      source: '1741751683774'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: llm-source-1741838758251-target
      source: llm
      sourceHandle: source
      target: '1741838758251'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: answer
      id: 1741838758251-source-answer-target
      source: '1741838758251'
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - allowed_file_extensions: []
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: file
          max_length: 5
          options: []
          required: true
          type: file-list
          variable: file
        - label: å›¾æ ‡ç±»å‹ï¼ˆæŸ±çŠ¶å›¾ã€çº¿æ€§å›¾è¡¨ã€é¥¼å›¾ã€é›·è¾¾å›¾ã€æ°”æ³¡å›¾ã€åŒYè½´å›¾ã€æ•£ç‚¹å›¾ï¼‰
          max_length: 48
          options:
          - æŸ±çŠ¶å›¾
          - çº¿æ€§å›¾è¡¨
          - é¥¼å›¾
          - é›·è¾¾å›¾
          - æ°”æ³¡å›¾
          - åŒYè½´å›¾
          - æ•£ç‚¹å›¾
          required: true
          type: select
          variable: tpye
      height: 115
      id: '1741751677458'
      position:
        x: -59
        y: 293
      positionAbsolute:
        x: -59
        y: 293
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}è¯·æ ¹æ®ç”¨æˆ·ä¸Šä¼ çš„excleè¡¨æ ¼{{#1741751683774.text#}}å°†è¡¨æ ¼ä»¥htmlå’Œ
            chart.jsç”Ÿæˆ{{#1741751677458.tpye#}}è¦æ±‚åªç”Ÿæˆhtmlå’Œchart.js ç­‰åœ¨æµè§ˆå™¨ç›´æ¥è¿è¡Œçš„ä»£ç ï¼Œå…¶ä»–è§£é‡Šå†…å®¹ä¸è¦è¾“å‡ºã€‚'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 10
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-V3
          provider: volcengine_maas
        prompt_template:
        - edition_type: basic
          id: 7729ac17-bbf7-4f97-aa30-8f1971d0027e
          role: system
          text: "# Role: Excelè¡¨æ ¼æ•°æ®å¯è§†åŒ–ä»£ç ç”Ÿæˆä¸“å®¶\n\n## Profile\n- ä¸“é•¿: å°†Excelè¡¨æ ¼æ•°æ®è½¬æ¢ä¸ºHTMLå’ŒChart.jså¯è§†åŒ–ä»£ç \n\
            - ç›®æ ‡: ç”Ÿæˆå‡†ç¡®åæ˜ åŸå§‹æ•°æ®çš„äº¤äº’å¼å›¾è¡¨\n\n## Background\næ‚¨æ˜¯ä¸€ä½ç²¾é€šæ•°æ®å¯è§†åŒ–çš„ç¼–ç¨‹ä¸“å®¶ï¼Œèƒ½å¤Ÿå°†Excelè¡¨æ ¼æ•°æ®ç²¾ç¡®è½¬æ¢ä¸ºä½¿ç”¨HTMLå’ŒChart.jsçš„äº¤äº’å¼å›¾è¡¨ã€‚\n\
            \n## Skills\n- ç²¾é€šHTMLã€JavaScriptå’ŒChart.jsåº“\n- èƒ½å¤Ÿå¤„ç†å¤šåˆ—Excelæ•°æ®ï¼Œä¿ç•™åŸå§‹åˆ—åå’Œæ•°æ®é¡¹åç§°\n\
            - å¯ä»¥ç”Ÿæˆå¤šç§ç±»å‹çš„å›¾è¡¨ï¼Œå¦‚æŸ±çŠ¶å›¾ã€çº¿æ€§å›¾è¡¨ã€é¥¼å›¾ã€é¢ç§¯å›¾ã€é›·è¾¾å›¾ã€æ°”æ³¡å›¾ã€åŒYè½´å›¾ã€æ•£ç‚¹å›¾ç­‰\n\n## Responsibilities\n\
            1. è§£æç”¨æˆ·æä¾›çš„Excelè¡¨æ ¼æ•°æ®ï¼ŒåŒ…æ‹¬åˆ—åå’Œå…·ä½“æ•°æ®é¡¹\n2. æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„å›¾è¡¨ç±»å‹ï¼Œç”Ÿæˆç›¸åº”çš„HTMLå’ŒChart.jsä»£ç \n\
            3. ç¡®ä¿ç”Ÿæˆçš„ä»£ç å®Œæ•´å±•ç¤ºæ‰€æœ‰åŸå§‹æ•°æ®ï¼ŒåŒ…æ‹¬å‡†ç¡®çš„åˆ—åå’Œæ•°æ®é¡¹åç§°\n4. ä¼˜åŒ–ä»£ç ä»¥å®ç°æœ€ä½³çš„å¯è§†åŒ–æ•ˆæœï¼ŒåŒæ—¶ä¿æŒæ•°æ®çš„åŸå§‹ç»“æ„å’Œå«ä¹‰\n\
            \n## Workflow\n1. æ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„Excelè¡¨æ ¼æ•°æ®å’ŒæŒ‡å®šçš„å›¾è¡¨ç±»å‹\n2. åˆ†æExcelæ•°æ®ç»“æ„ï¼ˆåˆ—æ•°ã€è¡Œæ•°ã€åˆ—æ ‡é¢˜ã€å…·ä½“æ•°æ®é¡¹ï¼‰\n\
            3. é€‰æ‹©é€‚åˆçš„Chart.jså›¾è¡¨ç±»å‹å’Œé…ç½®\n4. ç”Ÿæˆå®Œæ•´çš„HTMLæ–‡æ¡£ï¼ŒåŒ…å«å¿…è¦çš„Chart.jsåº“å¼•ç”¨\n5. åˆ›å»ºcanvaså…ƒç´ å’Œå¯¹åº”çš„JavaScriptä»£ç \n\
            6. ä½¿ç”¨åŸå§‹Excelæ•°æ®å¡«å……å›¾è¡¨é…ç½®\n7. åœ¨HTMLä¸­æ·»åŠ ä¸€ä¸ªè¡¨æ ¼å…ƒç´ ï¼Œå®Œæ•´å±•ç¤ºåŸå§‹Excelæ•°æ®å†…å®¹\n8. ç¡®ä¿æ‰€æœ‰åˆ—åå’Œæ•°æ®é¡¹åç§°åœ¨å›¾è¡¨å’Œè¡¨æ ¼ä¸­å¾—åˆ°å‡†ç¡®åæ˜ \n\
            \n## Guidelines\n1. åªè¾“å‡ºå¯ç›´æ¥è¿è¡Œçš„HTMLä»£ç ï¼Œä¸åŒ…æ‹¬å…¶ä»–è¯´æ˜æˆ–æ³¨é‡Š\n2. ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Chart.jsåº“ï¼ˆCDNé“¾æ¥ï¼‰\n\
            3. å°†Excelçš„åˆ—åç”¨ä½œå›¾è¡¨çš„æ ‡ç­¾æˆ–å›¾ä¾‹\n4. åœ¨æ•°æ®é›†ä¸­ä½¿ç”¨Excelçš„åŸå§‹æ•°æ®é¡¹åç§°\n5. æ ¹æ®æ•°æ®ç‰¹æ€§è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„é¢œè‰²æ–¹æ¡ˆ\n\
            6. ä¸ºå›¾è¡¨æ·»åŠ é€‚å½“çš„æ ‡é¢˜ï¼Œåæ˜ æ•°æ®å†…å®¹\n7. ç¡®ä¿ç”Ÿæˆçš„å›¾è¡¨å…·æœ‰å“åº”å¼è®¾è®¡ï¼Œé€‚åº”ä¸åŒå±å¹•å¤§å°\n\n## Output Format\n\
            ```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"\
            UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\
            >\n    <title>Excelæ•°æ®å¯è§†åŒ–</title>\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"\
            ></script>\n    <style>\n        table {\n            width: 100%;\n \
            \           border-collapse: collapse;\n            margin-bottom: 20px;\n\
            \        }\n        table, th, td {\n            border: 1px solid #ddd;\n\
            \        }\n        th, td {\n            padding: 8px;\n            text-align:\
            \ left;\n        }\n        th {\n            background-color: #f2f2f2;\n\
            \        }\n        .chart-container {\n            max-width: 800px;\n\
            \            margin: auto;\n        }\n    </style>\n</head>\n<body>\n\
            \    <h1 style=\"text-align: center;\">Excelæ•°æ®å¯è§†åŒ–</h1>\n\n    <!-- åŸå§‹è¡¨æ ¼\
            \ -->\n    <h2 style=\"text-align: center;\">åŸå§‹æ•°æ®è¡¨</h2>\n    <table>\n\
            \        <thead>\n            <tr>\n                <!-- Excelåˆ—åå°†æ’å…¥æ­¤å¤„\
            \ -->\n            </tr>\n        </thead>\n        <tbody>\n        \
            \    <!-- Excelæ•°æ®è¡Œå°†æ’å…¥æ­¤å¤„ -->\n        </tbody>\n    </table>\n\n    <!--\
            \ å›¾è¡¨å®¹å™¨ -->\n    <div class=\"chart-container\">\n        <canvas id=\"\
            myChart\"></canvas>\n    </div>\n\n    <script>\n        // è¿™é‡Œæ˜¯Chart.jsé…ç½®å’Œæ•°æ®ï¼Œä½¿ç”¨Excelçš„åŸå§‹åˆ—åå’Œæ•°æ®é¡¹åç§°\n\
            \    </script>\n</body>\n</html>"
        - id: 2fe2bc50-631c-4afb-a509-b7a2de4f85b6
          role: user
          text: ''
        selected: false
        title: å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆhtmlä»£ç 
        type: llm
        variables: []
        vision:
          enabled: false
      height: 97
      id: llm
      position:
        x: 548.2634662419989
        y: 293
      positionAbsolute:
        x: 548.2634662419989
        y: 293
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: " {{#llm.text#}}\n  {{#1741838758251.markdown_result#}}"
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 120
      id: answer
      position:
        x: 1196.5799984781631
        y: 293
      positionAbsolute:
        x: 1196.5799984781631
        y: 293
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_array_file: true
        selected: false
        title: æ–‡æ¡£æå–å™¨
        type: document-extractor
        variable_selector:
        - '1741751677458'
        - file
      height: 91
      id: '1741751683774'
      position:
        x: 241
        y: 293
      positionAbsolute:
        x: 241
        y: 293
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nimport re\nimport time\nimport requests\n\ndef main(json_html:\
          \ str, apikey: str,apiurl: str,strtype: str) -> dict:\n    try:\n      \
          \  # å»é™¤è¾“å…¥å­—ç¬¦ä¸²ä¸­çš„ ```html å’Œ ``` æ ‡è®°\n        html_content = re.sub(r'^```html\\\
          s*|\\s*```$', '', json_html, flags=re.DOTALL).strip()\n        \n      \
          \  # ç”Ÿæˆæ—¶é—´æˆ³ï¼Œç¡®ä¿æ–‡ä»¶åå”¯ä¸€\n        timestamp = int(time.time())\n        filename\
          \ = f\"{strtype}_{timestamp}.html\"\n        \n        # APIç«¯ç‚¹ï¼ˆå‡è®¾æœ¬åœ°è¿è¡Œï¼‰\n\
          \        url = f\"{apiurl}\"\n        \n        # è¯·æ±‚æ•°æ®\n        payload\
          \ = {\n            \"html_content\": html_content,\n            \"filename\"\
          : filename  # ä½¿ç”¨ä¼ å…¥çš„æ–‡ä»¶å\n        }\n        \n        # è®¾ç½®è¯·æ±‚å¤´ï¼ˆåŒ…å«è®¤è¯tokenï¼‰\n\
          \        headers = {\n            \"Authorization\": f\"Bearer {apikey}\"\
          ,  # æ›¿æ¢ä¸ºå®é™…çš„è®¤è¯token\n            \"Content-Type\": \"application/json\"\n\
          \        }\n        \n        try:\n            # å‘é€POSTè¯·æ±‚\n           \
          \ response = requests.post(url, json=payload, headers=headers)\n       \
          \     \n            # æ£€æŸ¥å“åº”çŠ¶æ€\n            if response.status_code == 200:\n\
          \                result = response.json()\n                html_url = result.get(\"\
          html_url\", \"\")\n                generated_filename = result.get(\"filename\"\
          , \"\")\n                \n                # è¿”å›ç»“æœ\n                return\
          \ {\n                    \"html_url\": html_url,\n                    \"\
          filename\": generated_filename,\n                    \"markdown_result\"\
          :  f\"[ç‚¹å‡»æŸ¥çœ‹]({html_url})\"\n                }\n            else:\n     \
          \           raise Exception(f\"HTTP Error: {response.status_code}, Message:\
          \ {response.text}\")\n        \n        except requests.exceptions.RequestException\
          \ as e:\n            raise Exception(f\"Request failed: {str(e)}\")\n  \
          \  \n    except Exception as e:\n        return {\n            \"error\"\
          : f\"Error: {str(e)}\"\n        }"
        code_language: python3
        desc: ''
        outputs:
          filename:
            children: null
            type: string
          html_url:
            children: null
            type: string
          markdown_result:
            children: null
            type: string
        selected: false
        title: ä»£ç å¤„ç†ç”Ÿæˆhtmlè°ƒç”¨
        type: code
        variables:
        - value_selector:
          - llm
          - text
          variable: json_html
        - value_selector:
          - env
          - apikey
          variable: apikey
        - value_selector:
          - env
          - apiurl
          variable: apiurl
        - value_selector:
          - '1741751677458'
          - tpye
          variable: strtype
      height: 53
      id: '1741838758251'
      position:
        x: 853
        y: 293
      positionAbsolute:
        x: 853
        y: 293
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        author: å‘¨è¾‰
        desc: ''
        height: 146
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æœ¬å·¥ä½œæµä¸»è¦åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ä»£ç ç”Ÿæˆèƒ½åŠ›é€šè¿‡ç”¨æˆ·è¾“å…¥çš„è¡¨æ ¼è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„HTMLä»£ç å¹¶åœ¨æœ€åæ¸²æŸ“å‡ºç»Ÿè®¡å›¾ç­‰åŠŸèƒ½ã€‚","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 373
      height: 146
      id: '1741851615864'
      position:
        x: -59
        y: 402.51139084999863
      positionAbsolute:
        x: -59
        y: 402.51139084999863
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 373
    viewport:
      x: 39.1609980089072
      y: -39.14721012184879
      zoom: 1.1533915300902233
